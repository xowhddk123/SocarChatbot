# 차량 파손 탐지 모델 개발

소속: 개인  
분야: Segmentation


> 학습에 사용된 이미지 들은 쏘카의 데이터로 공개 불가

## 프로젝트 개요

### 프로젝트 목표

> 차량 이미지를 입력하면 파손 여부, 파손 위치, 파손 종류를 출력하는 모델 개발
> 

### 프로젝트 조건

- Dent(찌그러짐), Scratch(긁힘), Spacing(이격)을 구분 가능해야함
- 파손이 없는 차량 이미지를 넣었을 때, 파손이 없다고 출력해야함

## 모델 기본 설계

### U-net++

![model](https://github.com/user-attachments/assets/9a7ff2eb-3d01-4335-bc7e-d73945ca8267)

- 각각의 모델이 하나의 파손 부위를 찾도록 학습
- U-Net++ 사용 이유
    - 기본적으로 많은 데이터를 확보하기 어려운 의료 데이터에 활용하기 위해 사용하던 모델이라 적은 데이터에도 우수한 성능을 보임
    - 마찬가지로 인간의 상처나 장기의 미세한 결함을 발견하기 위해 고안된 모델이라 파손 영역처럼 미세한 부분도 잘 포착할 수 있을 것으로 판단
    - 컨텍스트 정보를 잘 사용하면서도 정확히 지역화함
    - end2end 구조로 속도가 빠름
- unet++는 skip pathways에서 dense convolution block 들을 통해 추출된 feature map들이 unet에 비해서 fine-grained detail을 더 잘 포착할 수 있음

### Data Augmentation

- 모델 훈련 중 분류에 실패한 이미지들을 모아서 분석한 결과 대부분 파손 영역의 크기가 전체 픽셀의 5% 미만인 경우가 많은 것으로 보아 학습 대상의 크기가 학습에 영향을 주는것으로 판단
- 데이터 증강을 위해 일반적인 회전, 반전 과 같은 방법이 아닌 [crop 이미지를 추가해 학습](https://github.com/xowhddk123/SocarChatbot/blob/a19ebbc9317278e3c2ab83b2c758defeeb512ca8/src/Datasets.py)
- 파손 부위를 반드시 포함하도록 하고 파손 영역 주위로 얼마나 crop할지는 매 학습마다 랜덤하게 결정 되도록 학습
- Data Augmentation을 적용하여 IoU score 10% 개선

### Output Channel

- 현재 과제의 경우 하나의 모델이 하나의 파손만을 찾으므로 일반적으로는 하나의 채널을 사용하여 이진분류 형태로 학습.
- 두 개의 채널을 사용하면 파손을 찾는 채널과 배경을 찾는 채널 두 개로 학습이 되어 성능이 개선
- 실제로 하나의 채널에 비해 두 개의 채널을 사용했을 때, IoU score가 5% 가량 개선

## 최종 결과물

![result](https://github.com/user-attachments/assets/17705da5-aab4-42a2-a544-4bca4fb6db32)

### 성능 평가

- 파손 영역을 Crop해 학습 하는 방법으로 IoU score 3% 개선
- 각 모델이 출력 채널을 2개로 하여 IoU score 30% 개선
- 최종적으로 75%의 IoU score 달성

## 느낀점과 한계

- 어떤 모델을 사용하는지 보다 데이터를 얼마나 학습에 적당하도록 전처리를 하는가가 성능에 더 큰 영향이 있었음
- 파손 영역의 boundary를 라벨링 해서 세 개의 채널로 학습을 하면 더 높은 성능을 기대할 수 있을 것으로 생각됨
